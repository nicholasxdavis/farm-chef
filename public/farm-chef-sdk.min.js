
!function(e){"use strict";const t="https://genodqiyehczgiqgxekv.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdlbm9kcWl5ZWhjemdpcWd4ZWt2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkzMjE4NDUsImV4cCI6MjA2NDg5Nzg0NX0.DFtdiPpjtSvWBqb92IQ1catvkhOGAu0n1NEIPj4g91E";let n;function r(){return new Promise((e,r)=>{if(window.supabase)return n=window.supabase.createClient(t,a),void e();const s=document.createElement("script");s.src="https://unpkg.com/@supabase/supabase-js@2",s.onload=()=>{n=window.supabase.createClient(t,a),e()},s.onerror=r,document.head.appendChild(s)})}class s{constructor(){this.isInitialized=!1,this.currentUser=null,this.authListeners=[],this.auth={signUp:async(e,t)=>{const{data:a,error:n}=await supabase.auth.signUp({email:e,password:t,options:{emailRedirectTo:window.location.origin}});return{user:a.user,error:n}},signIn:async(e,t)=>{const{data:a,error:n}=await supabase.auth.signInWithPassword({email:e,password:t});return{user:a.user,error:n}},signOut:async()=>{const{error:e}=await supabase.auth.signOut();return{error:e}},getCurrentUser:()=>this.currentUser,onAuthStateChange:e=>(this.authListeners.push(e),()=>{const t=this.authListeners.indexOf(e);t>-1&&this.authListeners.splice(t,1)})},this.menu={getItems:async()=>{const{data:e,error:t}=await n.from("menu_items").select("*").eq("is_available",!0).order("created_at",{ascending:!1});return{data:e,error:t}},getAllItems:async()=>{const{data:e,error:t}=await n.from("menu_items").select("*").order("created_at",{ascending:!1});return{data:e,error:t}},createItem:async e=>{const{data:t,error:a}=await n.from("menu_items").insert([e]).select();return{data:t,error:a}},updateItem:async(e,t)=>{const{data:a,error:r}=await n.from("menu_items").update(t).eq("id",e).select();return{data:a,error:r}},deleteItem:async e=>{const{error:t}=await n.from("menu_items").delete().eq("id",e);return{error:t}},subscribe:e=>{const t=n.channel("menu-changes").on("postgres_changes",{event:"*",schema:"public",table:"menu_items"},e).subscribe();return()=>{n.removeChannel(t)}}},this.ui={generateMenuHTML:(e,t={})=>{const{containerClass:a="farm-chef-menu",itemClass:n="farm-chef-menu-item",showPrice:r=!0,showCategory:s=!0}=t;return`<div class="${a}">${e.map(e=>`\n          <div class="${n}" data-id="${e.id}">\n            <div class="menu-item-image">\n              <img src="${e.image_url||"https://via.placeholder.com/300x200"}" alt="${e.name}" onerror="this.src='https://via.placeholder.com/300x200'" />\n            </div>\n            <div class="menu-item-content">\n              <div class="menu-item-header">\n                <h3 class="menu-item-name">${e.name}</h3>\n                ${r?`<span class="menu-item-price">$${e.price.toFixed(2)}</span>`:""}\n              </div>\n              <p class="menu-item-description">${e.description||""}</p>\n              ${s?`<span class="menu-item-category">${e.category}</span>`:""}\n            </div>\n          </div>\n        `).join("")}</div>`},generateAuthHTML:(e={})=>{const{containerClass:t="farm-chef-auth",showSignUp:a=!0,showSignIn:n=!0}=e;return`\n          <div class="${t}">\n            ${n?'\n              <form class="farm-chef-signin-form">\n                <h3>Sign In</h3>\n                <input type="email" placeholder="Email" required class="signin-email" />\n                <input type="password" placeholder="Password" required class="signin-password" />\n                <button type="submit">Sign In</button>\n                <div class="auth-message"></div>\n              </form>\n            ':""}\n            \n            ${a?'\n              <form class="farm-chef-signup-form">\n                <h3>Sign Up</h3>\n                <input type="email" placeholder="Email" required class="signup-email" />\n                <input type="password" placeholder="Password" required class="signup-password" />\n                <button type="submit">Sign Up</button>\n                <div class="auth-message"></div>\n              </form>\n            ':""}\n            \n            <div class="farm-chef-user-info" style="display: none;">\n              <p>Welcome, <span class="user-email"></span>!</p>\n              <button class="farm-chef-signout">Sign Out</button>\n            </div>\n          </div>\n        `},generateDashboardHTML:(e={})=>{const{containerClass:t="farm-chef-dashboard"}=e;return`\n          <div class="${t}">\n            <h2>Menu Management Dashboard</h2>\n            \n            <form class="farm-chef-add-item-form">\n              <h3>Add New Menu Item</h3>\n              <input type="text" placeholder="Item Name" required class="item-name" />\n              <textarea placeholder="Description" class="item-description"></textarea>\n              <input type="number" placeholder="Price" step="0.01" required class="item-price" />\n              <input type="url" placeholder="Image URL" class="item-image-url" />\n              <input type="text" placeholder="Category" required class="item-category" />\n              <label>\n                <input type="checkbox" class="item-available" checked />\n                Available\n              </label>\n              <button type="submit">Add Item</button>\n              <div class="form-message"></div>\n            </form>\n            \n            <div class="farm-chef-menu-items-list">\n              <!-- Menu items will be populated here -->\n            </div>\n          </div>\n        `},attachEventListeners:e=>{const t=e.querySelector(".farm-chef-signin-form"),a=e.querySelector(".farm-chef-signup-form"),n=e.querySelector(".farm-chef-signout"),r=e.querySelector(".farm-chef-add-item-form");t&&t.addEventListener("submit",async e=>{e.preventDefault();const a=t.querySelector(".auth-message"),n=t.querySelector(".signin-email").value,r=t.querySelector(".signin-password").value;try{const{user:e,error:t}=await this.auth.signIn(n,r);t?a.innerHTML='<p style="color: red;">Sign in failed: '+t.message+"</p>":a.innerHTML='<p style="color: green;">Signed in successfully!</p>'}catch(e){a.innerHTML='<p style="color: red;">Sign in error: '+e.message+"</p>"}}),a&&a.addEventListener("submit",async e=>{e.preventDefault();const t=a.querySelector(".auth-message"),n=a.querySelector(".signup-email").value,r=a.querySelector(".signup-password").value;try{const{user:e,error:a}=await this.auth.signUp(n,r);a?t.innerHTML='<p style="color: red;">Sign up failed: '+a.message+"</p>":t.innerHTML='<p style="color: green;">Sign up successful! Please check your email to confirm.</p>'}catch(e){t.innerHTML='<p style="color: red;">Sign up error: '+e.message+"</p>"}}),n&&n.addEventListener("click",async()=>{await this.auth.signOut()}),r&&r.addEventListener("submit",async e=>{e.preventDefault();const t=r.querySelector(".form-message"),a={name:r.querySelector(".item-name").value,description:r.querySelector(".item-description").value,price:parseFloat(r.querySelector(".item-price").value),image_url:r.querySelector(".item-image-url").value,category:r.querySelector(".item-category").value,is_available:r.querySelector(".item-available").checked};try{const{data:e,error:n}=await this.menu.createItem(a);n?t.innerHTML='<p style="color: red;">Failed to add item: '+n.message+"</p>":(t.innerHTML='<p style="color: green;">Item added successfully!</p>',r.reset())}catch(e){t.innerHTML='<p style="color: red;">Error adding item: '+e.message+"</p>"}}),this.auth.onAuthStateChange(t=>{const a=e.querySelectorAll(".farm-chef-signin-form, .farm-chef-signup-form"),n=e.querySelector(".farm-chef-user-info"),r=e.querySelector(".user-email");t?(a.forEach(e=>e.style.display="none"),n&&(n.style.display="block",r&&(r.textContent=t.email))):(a.forEach(e=>e.style.display="block"),n&&(n.style.display="none"))})}}}async init(){if(this.isInitialized)return;try{await r(),n.auth.onAuthStateChange((e,t)=>{this.currentUser=t?.user||null,this.authListeners.forEach(a=>a(this.currentUser,e))});const{data:{session:e}}=await n.auth.getSession();this.currentUser=e?.user||null,this.isInitialized=!0,console.log("FarmChef SDK initialized successfully")}catch(e){throw console.error("Failed to initialize FarmChef SDK:",e),e}}getDefaultCSS(){return'\n        .farm-chef-menu {\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n          gap: 1rem;\n          padding: 1rem;\n        }\n        \n        .farm-chef-menu-item {\n          border: 1px solid #e2e8f0;\n          border-radius: 8px;\n          overflow: hidden;\n          transition: box-shadow 0.2s;\n          background: white;\n        }\n        \n        .farm-chef-menu-item:hover {\n          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n        }\n        \n        .menu-item-image img {\n          width: 100%;\n          height: 200px;\n          object-fit: cover;\n        }\n        \n        .menu-item-content {\n          padding: 1rem;\n        }\n        \n        .menu-item-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 0.5rem;\n        }\n        \n        .menu-item-name {\n          margin: 0;\n          font-size: 1.1rem;\n          font-weight: 600;\n        }\n        \n        .menu-item-price {\n          font-size: 1.2rem;\n          font-weight: bold;\n          color: #16a34a;\n        }\n        \n        .menu-item-description {\n          color: #64748b;\n          font-size: 0.9rem;\n          margin-bottom: 0.5rem;\n        }\n        \n        .menu-item-category {\n          background: #e0f2fe;\n          color: #0369a1;\n          padding: 0.25rem 0.5rem;\n          border-radius: 9999px;\n          font-size: 0.75rem;\n        }\n        \n        .farm-chef-auth {\n          max-width: 400px;\n          margin: 0 auto;\n          padding: 1rem;\n        }\n        \n        .farm-chef-auth form {\n          margin-bottom: 1rem;\n          padding: 1rem;\n          border: 1px solid #e2e8f0;\n          border-radius: 8px;\n        }\n        \n        .farm-chef-auth h3 {\n          margin-bottom: 1rem;\n          margin-top: 0;\n        }\n        \n        .farm-chef-auth input {\n          width: 100%;\n          padding: 0.5rem;\n          margin-bottom: 0.5rem;\n          border: 1px solid #e2e8f0;\n          border-radius: 4px;\n          box-sizing: border-box;\n        }\n        \n        .farm-chef-auth button {\n          width: 100%;\n          padding: 0.75rem;\n          background: #3b82f6;\n          color: white;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n        \n        .farm-chef-auth button:hover {\n          background: #2563eb;\n        }\n        \n        .farm-chef-user-info {\n          text-align: center;\n          padding: 1rem;\n          background: #f0f9ff;\n          border-radius: 8px;\n        }\n        \n        .farm-chef-dashboard {\n          max-width: 800px;\n          margin: 0 auto;\n          padding: 1rem;\n        }\n        \n        .farm-chef-add-item-form {\n          background: #f8fafc;\n          padding: 1rem;\n          border-radius: 8px;\n          margin-bottom: 2rem;\n          border: 1px solid #e2e8f0;\n        }\n        \n        .farm-chef-add-item-form input,\n        .farm-chef-add-item-form textarea {\n          width: 100%;\n          padding: 0.5rem;\n          margin-bottom: 0.5rem;\n          border: 1px solid #e2e8f0;\n          border-radius: 4px;\n          box-sizing: border-box;\n        }\n        \n        .farm-chef-add-item-form button {\n          background: #16a34a;\n          color: white;\n          padding: 0.75rem 1.5rem;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n        \n        .farm-chef-add-item-form button:hover {\n          background: #15803d;\n        }\n        \n        .auth-message, .form-message {\n          margin-top: 0.5rem;\n        }\n        \n        .auth-message p, .form-message p {\n          margin: 0;\n          padding: 0.5rem;\n          border-radius: 4px;\n        }\n      '}injectCSS(){const e=document.getElementById("farm-chef-styles");if(!e){const e=document.createElement("style");e.id="farm-chef-styles",e.textContent=this.getDefaultCSS(),document.head.appendChild(e)}}}const i=new s;e.FarmChef=i,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{i.init().catch(console.error)}):i.init().catch(console.error)}(window);
